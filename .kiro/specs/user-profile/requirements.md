# 需求文档

## 简介

个人中心功能为行动手帐应用提供用户个人信息管理能力。用户可以查看和编辑个人资料（昵称、头像），查看账户信息，以及管理应用设置。所有用户数据将同步保存到 Supabase 数据库中。

## 术语表

- **个人中心（Profile Center）**: 用户管理个人信息和账户设置的页面
- **用户资料（User Profile）**: 用户的个人信息，包括昵称、头像等
- **Supabase**: 项目使用的后端即服务平台，提供数据库和认证服务
- **头像（Avatar）**: 用户的个人图片标识

## 需求

### 需求 1

**用户故事:** 作为已登录用户，我想查看我的个人资料，以便了解我的账户信息。

#### 验收标准

1. WHEN 用户访问个人中心页面 THEN 系统 SHALL 显示用户的邮箱地址
2. WHEN 用户访问个人中心页面 THEN 系统 SHALL 显示用户的昵称（如已设置）或默认显示"未设置昵称"
3. WHEN 用户访问个人中心页面 THEN 系统 SHALL 显示用户的头像（如已设置）或默认头像
4. WHEN 用户访问个人中心页面 THEN 系统 SHALL 显示账户注册时间

### 需求 2

**用户故事:** 作为已登录用户，我想编辑我的昵称，以便其他功能可以显示我的个性化名称。

#### 验收标准

1. WHEN 用户点击编辑昵称按钮 THEN 系统 SHALL 显示昵称输入框
2. WHEN 用户输入有效昵称（1-20个字符）并保存 THEN 系统 SHALL 将昵称保存到数据库并更新显示
3. WHEN 用户输入空白昵称并保存 THEN 系统 SHALL 拒绝保存并显示错误提示
4. WHEN 用户输入超过20个字符的昵称 THEN 系统 SHALL 拒绝保存并显示长度限制提示
5. WHEN 昵称保存成功 THEN 系统 SHALL 显示保存成功的反馈

### 需求 3

**用户故事:** 作为已登录用户，我想上传或更换我的头像，以便个性化我的账户。

#### 验收标准

1. WHEN 用户点击头像区域 THEN 系统 SHALL 打开图片选择器
2. WHEN 用户选择有效图片文件（JPG/PNG，小于5MB）THEN 系统 SHALL 上传图片并更新头像显示
3. WHEN 用户选择无效文件格式 THEN 系统 SHALL 显示格式错误提示
4. WHEN 用户选择超过5MB的图片 THEN 系统 SHALL 显示文件过大提示
5. WHEN 头像上传成功 THEN 系统 SHALL 将头像URL保存到数据库

### 需求 4

**用户故事:** 作为已登录用户，我想从个人中心退出登录，以便安全地结束会话。

#### 验收标准

1. WHEN 用户点击退出登录按钮 THEN 系统 SHALL 显示确认对话框
2. WHEN 用户确认退出 THEN 系统 SHALL 清除会话并跳转到登录页面
3. WHEN 用户取消退出 THEN 系统 SHALL 关闭对话框并保持当前状态

### 需求 5

**用户故事:** 作为系统，我需要将用户资料数据持久化到数据库，以便用户在不同设备上访问时数据保持一致。

#### 验收标准

1. WHEN 用户资料被创建或更新 THEN 系统 SHALL 将数据同步保存到 Supabase 数据库
2. WHEN 用户登录 THEN 系统 SHALL 从数据库加载用户资料
3. WHEN 数据库操作失败 THEN 系统 SHALL 显示友好的错误提示
4. WHEN 用户资料序列化到数据库 THEN 系统 SHALL 使用 JSON 格式存储扩展字段

### 需求 6

**用户故事:** 作为用户，我想在个人中心查看我的使用统计摘要，以便快速了解我的使用情况。

#### 验收标准

1. WHEN 用户访问个人中心页面 THEN 系统 SHALL 显示总任务完成数
2. WHEN 用户访问个人中心页面 THEN 系统 SHALL 显示连续打卡天数
3. WHEN 用户访问个人中心页面 THEN 系统 SHALL 显示已封存的记录总数

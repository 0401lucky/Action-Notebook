# 需求文档

## 简介

番茄钟功能是行动手帐应用的专注计时模块，帮助用户使用番茄工作法进行时间管理。用户可以通过导航栏图标快速进入番茄钟页面，选择关联任务进行专注计时，系统会记录专注时长并提供统计数据。

## 术语表

- **番茄钟系统 (Pomodoro_System)**：管理专注计时、休息计时和专注记录的核心模块
- **专注时段 (Focus_Session)**：一个完整的番茄钟工作周期，默认 25 分钟
- **短休息 (Short_Break)**：专注时段之间的短暂休息，默认 5 分钟
- **长休息 (Long_Break)**：完成多个专注时段后的较长休息，默认 15 分钟
- **计时器状态 (Timer_State)**：计时器的当前状态，包括空闲、专注中、休息中、暂停
- **专注记录 (Focus_Record)**：记录每次专注的详细信息，包括时长、关联任务等

## 需求

### 需求 1

**用户故事：** 作为用户，我希望能从导航栏快速进入番茄钟页面，以便随时开始专注计时。

#### 验收标准

1. WHEN 用户查看导航栏 THEN 番茄钟系统 SHALL 显示一个番茄钟图标按钮
2. WHEN 用户点击番茄钟图标 THEN 番茄钟系统 SHALL 导航到番茄钟页面
3. WHEN 用户处于番茄钟页面 THEN 番茄钟系统 SHALL 在导航栏高亮显示番茄钟图标

### 需求 2

**用户故事：** 作为用户，我希望能启动、暂停和重置番茄钟计时器，以便灵活控制我的专注时间。

#### 验收标准

1. WHEN 计时器处于空闲状态且用户点击开始按钮 THEN 番茄钟系统 SHALL 开始倒计时并显示剩余时间
2. WHEN 计时器处于运行状态且用户点击暂停按钮 THEN 番茄钟系统 SHALL 暂停倒计时并保持当前剩余时间
3. WHEN 计时器处于暂停状态且用户点击继续按钮 THEN 番茄钟系统 SHALL 从暂停位置继续倒计时
4. WHEN 用户点击重置按钮 THEN 番茄钟系统 SHALL 停止计时并将时间重置为初始值
5. WHEN 计时器正在运行 THEN 番茄钟系统 SHALL 每秒更新一次显示的剩余时间

### 需求 3

**用户故事：** 作为用户，我希望在专注时段结束后自动进入休息模式，以便遵循番茄工作法的节奏。

#### 验收标准

1. WHEN 专注时段倒计时结束 THEN 番茄钟系统 SHALL 播放提示音并显示通知
2. WHEN 专注时段结束 THEN 番茄钟系统 SHALL 自动切换到休息模式并开始休息倒计时
3. WHEN 用户完成少于 4 个专注时段 THEN 番茄钟系统 SHALL 进入短休息模式（5 分钟）
4. WHEN 用户完成 4 个专注时段 THEN 番茄钟系统 SHALL 进入长休息模式（15 分钟）并重置专注计数
5. WHEN 休息时段结束 THEN 番茄钟系统 SHALL 播放提示音并自动切换回专注模式

### 需求 4

**用户故事：** 作为用户，我希望能将番茄钟与具体任务关联，以便追踪每个任务的专注时间。

#### 验收标准

1. WHEN 用户开始专注前 THEN 番茄钟系统 SHALL 显示今日未完成任务列表供选择
2. WHEN 用户选择一个任务并开始专注 THEN 番茄钟系统 SHALL 在计时界面显示当前关联的任务名称
3. WHEN 用户不选择任务直接开始 THEN 番茄钟系统 SHALL 允许无任务关联的自由专注
4. WHEN 专注时段完成且关联了任务 THEN 番茄钟系统 SHALL 将专注时长记录到该任务

### 需求 5

**用户故事：** 作为用户，我希望能自定义番茄钟的时长设置，以便适应我的工作习惯。

#### 验收标准

1. WHEN 用户打开设置面板 THEN 番茄钟系统 SHALL 显示专注时长、短休息时长、长休息时长的配置选项
2. WHEN 用户修改专注时长 THEN 番茄钟系统 SHALL 接受 1 到 60 分钟范围内的整数值
3. WHEN 用户修改休息时长 THEN 番茄钟系统 SHALL 接受 1 到 30 分钟范围内的整数值
4. WHEN 用户保存设置 THEN 番茄钟系统 SHALL 持久化配置并在下次计时时使用新设置
5. WHEN 用户输入超出范围的值 THEN 番茄钟系统 SHALL 显示验证错误并阻止保存

### 需求 6

**用户故事：** 作为用户，我希望能查看我的专注统计数据，以便了解我的专注习惯和效率。

#### 验收标准

1. WHEN 用户查看番茄钟页面 THEN 番茄钟系统 SHALL 显示今日完成的专注时段数量
2. WHEN 用户查看统计区域 THEN 番茄钟系统 SHALL 显示今日累计专注时长（分钟）
3. WHEN 专注时段完成 THEN 番茄钟系统 SHALL 实时更新统计数据

### 需求 7

**用户故事：** 作为用户，我希望专注记录能够持久化存储，以便在刷新页面或重新登录后保留数据。

#### 验收标准

1. WHEN 专注时段完成 THEN 番茄钟系统 SHALL 将专注记录保存到本地存储
2. WHEN 用户已登录且专注时段完成 THEN 番茄钟系统 SHALL 将专注记录同步到数据库
3. WHEN 用户打开番茄钟页面 THEN 番茄钟系统 SHALL 从存储加载今日的专注记录
4. WHEN 数据库不可用 THEN 番茄钟系统 SHALL 回退到本地存储并在恢复后同步

### 需求 8

**用户故事：** 作为用户，我希望番茄钟界面美观且响应式，以便在不同设备上获得良好体验。

#### 验收标准

1. WHEN 用户查看番茄钟页面 THEN 番茄钟系统 SHALL 显示圆形进度指示器展示剩余时间比例
2. WHEN 计时器状态改变 THEN 番茄钟系统 SHALL 通过颜色变化区分专注模式和休息模式
3. WHEN 用户在移动设备上访问 THEN 番茄钟系统 SHALL 自适应调整布局保持可用性
